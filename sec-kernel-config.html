<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Chapter 11. Linux Kernel</title><link rel="stylesheet" type="text/css" href="style.css" /><link rel="stylesheet" type="text/css" href="highlight/styles/monokai.css" /><script src="highlight/highlight.pack.js" type="text/javascript"></script><script src="highlight/init.js" type="text/javascript"></script><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="NixOS Manual" /><link rel="up" href="ch-configuration.html" title="Part II. Configuration" /><link rel="prev" href="sec-networking.html" title="Chapter 10. Networking" /><link rel="next" href="module-postgresql.html" title="Chapter 12. PostgreSQL" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 11. Linux Kernel</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="sec-networking.html">Prev</a> </td><th width="60%" align="center">Part II. Configuration</th><td width="20%" align="right"> <a accesskey="n" href="module-postgresql.html">Next</a></td></tr></table><hr /></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="sec-kernel-config"></a>Chapter 11. Linux Kernel</h2></div></div></div><p>You can override the Linux kernel and associated packages using
the option <code class="option">boot.kernelPackages</code>.  For instance, this
selects the Linux 3.10 kernel:
</p><pre class="programlisting">
boot.kernelPackages = pkgs.linuxPackages_3_10;
</pre><p>
Note that this not only replaces the kernel, but also packages that
are specific to the kernel version, such as the NVIDIA video drivers.
This ensures that driver packages are consistent with the
kernel.</p><p>The default Linux kernel configuration should be fine for most users. You can see the configuration of your current kernel with the following command:
</p><pre class="programlisting">
cat /proc/config.gz | gunzip
</pre><p>
If you want to change the kernel configuration, you can use the
<code class="option">packageOverrides</code> feature (see <a class="xref" href="sec-package-management.html#sec-customising-packages" title="6.1.1. Customising Packages">Section 6.1.1, “Customising Packages”</a>).  For instance, to enable
support for the kernel debugger KGDB:

</p><pre class="programlisting">
nixpkgs.config.packageOverrides = pkgs:
  { linux_3_4 = pkgs.linux_3_4.override {
      extraConfig =
        ''
          KGDB y
        '';
    };
  };
</pre><p>

<code class="varname">extraConfig</code> takes a list of Linux kernel
configuration options, one per line.  The name of the option should
not include the prefix <code class="literal">CONFIG_</code>.  The option value
is typically <code class="literal">y</code>, <code class="literal">n</code> or
<code class="literal">m</code> (to build something as a kernel module).</p><p>Kernel modules for hardware devices are generally loaded
automatically by <span class="command"><strong>udev</strong></span>.  You can force a module to
be loaded via <code class="option">boot.kernelModules</code>, e.g.
</p><pre class="programlisting">
boot.kernelModules = [ "fuse" "kvm-intel" "coretemp" ];
</pre><p>
If the module is required early during the boot (e.g. to mount the
root file system), you can use
<code class="option">boot.initrd.extraKernelModules</code>:
</p><pre class="programlisting">
boot.initrd.extraKernelModules = [ "cifs" ];
</pre><p>
This causes the specified modules and their dependencies to be added
to the initial ramdisk.</p><p>Kernel runtime parameters can be set through
<code class="option">boot.kernel.sysctl</code>, e.g.
</p><pre class="programlisting">
boot.kernel.sysctl."net.ipv4.tcp_keepalive_time" = 120;
</pre><p>
sets the kernel’s TCP keepalive time to 120 seconds.  To see the
available parameters, run <span class="command"><strong>sysctl -a</strong></span>.</p></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="sec-networking.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch-configuration.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="module-postgresql.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 10. Networking </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 12. PostgreSQL</td></tr></table></div></body></html>